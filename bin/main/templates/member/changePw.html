<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout2}">
<head>
	<meta charset="UTF-8">
<title>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</title>
<meta id="_csrf" name="_csrf" th:content="${_csrf.token}"/>
<meta id="_csrf_header" name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>
<th:block layout:fragment="css">
<style>
	#password_1,#password_2{
	border:2px solid #04479b;
	border-radius: 5px;
	background-color: #d3d3d38a;
	height: 27px; 
	width: 430px;
	}
	button,#btn{
	border:2px solid #04479b;
	width: 100px; border-radius: 5px;
	float: right; margin: 1px;
	}
	button:hover {
	cursor: pointer;
	}
	form{
	margin: auto; margin-top:10%;
	width:35%;
	padding: 50px;
	}
	label{
	font-size: 20px;
	}
	
</style>
</th:block>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>   
<script>
	function validateForm(form){
		if (form.password.value == ""){
			alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
			return false;
		}
		if (form.password2.value == ""){
			alert("ë¹„ë°€ë²ˆí˜¸ ì²´í¬ë¥¼ í•´ì£¼ì„¸ìš”.");
			return false;
		}
		if (form.password.value != form.password2.value){
			alert("ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
			return false;
		}
		var reg = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/;
		var password = form.password.value;
		console.log(password);
	   	if( !reg.test(password)){
	   	 	alert("ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ, í•˜ë‚˜ ì´ìƒì˜ ë¬¸ì, ìˆ«ìì™€ í•˜ë‚˜ì˜ ìƒì˜ íŠ¹ìˆ˜ë¬¸ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
	   	 	return false; 
	   	}
	}
</script>
<body>
<div layout:fragment="content2">
<form action="/members/foundPw" method="post" name="updateForm" th:onsubmit="return validateForm(this);" enctype="multipart/form-data">
	<h1>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ğŸ”’</h1>
	<div>
		<label th:for="password">ë¹„ë°€ë²ˆí˜¸</label>
		<input type="password" id="password_1" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸+ìˆ«ì+íŠ¹ìˆ˜ë¬¸ìë¥¼ í˜¼í•©í•˜ì—¬ 8ì ì´ìƒìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”."><br>
 		<input type="hidden" id="email" name="email" th:value=${email} />
	</div>
	<div>
		<label th:for="password2">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
		<input type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”." id="password_2" name="password2">
    	<div style="display: inline-block"><font id = "checkPw" size = "2" /></font></div><br/>
		<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
	</div>
	<button type="submit">ìˆ˜ì •í•˜ê¸°</button>
	<input type="button" id="btn" onclick="location.href='/members/login'" value="ì·¨ì†Œ">
</form>
<script>
	$('#password_2').keyup(function(){
		let pass1 = document.getElementById('password_1').value;
		let pass2 = document.getElementById('password_2').value;
            
		if (pass1 != "" && pass2 != ""){
			if (pass1 == pass2){
				$("#checkPw").html('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤');
				$("#checkPw").attr('color','#2fb380');
				$("#password_2").addClass("is-valid");
				$("#password_2").removeClass("is-invalid");
				$("#btnConfirm").prop("disabled",false);
			} else {
				$("#checkPw").html('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
				$("#checkPw").attr('color','#dc3545');
				$("#password_2").removeClass("is-valid");                  
				$("#password_2").addClass("is-invalid");
				$("#btnConfirm").prop("disabled",true);
			}
		}else if (pass1 != "" && pass2 == ""){
			$("#checkPw").html('');
			$("#checkPw").attr('color','whie');
			$("#password_2").addClass("is-valid");
			$("#password_2").removeClass("is-invalid");
			$("#btnConfirm").prop("disabled",false);
		}
	});      
	$('#password_1').keyup(function(){
		let pass1 = document.getElementById('password_1').value;
		let pass2 = document.getElementById('password_2').value;
        
		if (pass1 != "" && pass2 != ""){
			if (pass1 == pass2){
				$("#checkPw").html('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤');
				$("#checkPw").attr('color','#2fb380');
				$("#password_2").addClass("is-valid");
				$("#password_2").removeClass("is-invalid");
				$("#btnConfirm").prop("disabled",false);
			} else {
				$("#checkPw").html('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
				$("#checkPw").attr('color','#dc3545');
				$("#password_2").removeClass("is-valid");                  
				$("#password_2").addClass("is-invalid");
				$("#btnConfirm").prop("disabled",true);
			}
		}
	});
</script>
</div>
</body>
</html>